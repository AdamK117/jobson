<!DOCTYPE html>
<html>

  <head>
    <title>Jobson Documentation</title>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1,
                                   maximum-scale=1, user-scalable=no">

    <link rel="stylesheet" type="text/css" href="main.css">
    
  </head>

  <body>
    <header id="header-site">
  <div class="wrap">
    <h1>Jobson</h1>
    <nav>
      <a href="index.html">docs</a>
      <a href="https://github.com/adamkewley/jobson">source</a>
      <a href="https://github.com/adamkewley/jobson/releases">download</a>
    </nav>
  </div>
</header>


    <header id="section-title">
      <div class="wrap">
	<h1>Template Strings</h1>
      </div>
    </header>

    <section id="content">
      <div class="wrap">
	<main id="content-primary">
	  <h1 id="template-strings">Template Strings</h1>

<p>Template strings, such as <code class="highlighter-rouge">${request.id}</code> allow developers to add
runtime evaluation to their job specs. For example, template strings
allow runtime input arguments to be used as application arguments:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">execution</span><span class="pi">:</span>
  <span class="na">application</span><span class="pi">:</span> <span class="s">bash</span>
  <span class="na">arguments</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">${inputs.firstName}</span>
</code></pre></div></div>

<p>This is the main way of passing client inputs into an application at
runtime.</p>

<p>Template strings are ordinary strings with support for special
expressions between <code class="highlighter-rouge">${</code> and <code class="highlighter-rouge">}</code>. Jobson interprets those expressions
at runtime, evaluating them against an environment containing data
(e.g. <code class="highlighter-rouge">inputs</code>, <code class="highlighter-rouge">request</code>) and functions (e.g. <code class="highlighter-rouge">toJSON</code>, <code class="highlighter-rouge">toFile</code>).</p>

<h2 id="template-string-functions--variables">Template String Functions + Variables</h2>

<p>Template strings have access to the following:</p>

<h3 id="string-tojsonobject-arg"><code class="highlighter-rouge">String toJSON(Object arg)</code></h3>

<p>A function that takes an input (e.g. <code class="highlighter-rouge">request</code>, <code class="highlighter-rouge">request.id</code>, <code class="highlighter-rouge">'string
literal'</code>) and returns a JSON representation of the
input. Object-/Hash-like arguments are converted into a JSON object,
strings are converted into a JSON string, numbers into JSON numbers,
etc.</p>

<h3 id="string-tofilestring-content"><code class="highlighter-rouge">String toFile(String content)</code></h3>

<p>A function that takes a string input (e.g. <code class="highlighter-rouge">request.id</code>,
<code class="highlighter-rouge">toJSON(request)</code>), write the input to a file, and returns an absolute
path to that file.</p>

<h3 id="string-joinstring-delimiter-stringarray-strings"><code class="highlighter-rouge">String join(String delimiter, StringArray strings)</code></h3>

<p>A function that takes a delimiter (e.g. <code class="highlighter-rouge">','</code>) and a <code class="highlighter-rouge">StringArray</code>
(usually, from a Jobson <code class="highlighter-rouge">string[]</code> <code class="highlighter-rouge">expectedInput</code>) and returns a
string that contains each element in the <code class="highlighter-rouge">StringArray</code> joined with the
delimiter.</p>

<h3 id="string-tostringobject-arg"><code class="highlighter-rouge">String toString(Object arg)</code></h3>

<p>A function that takes an argument (e.g. <code class="highlighter-rouge">request.firstName</code>) and
returns a string representation of that arugment. Note: internally,
this uses the Java <code class="highlighter-rouge">.toString</code> method on the argument, which may
produce non-obvious results with complex arguments.</p>

<h3 id="object-request"><code class="highlighter-rouge">Object request</code></h3>

<p>A reference to the request that initiated the job. Useful fields in
the request are:</p>

<ul>
  <li><code class="highlighter-rouge">String id</code>: The job’s ID (e.g. <code class="highlighter-rouge">57s9fmopb</code>)</li>
  <li><code class="highlighter-rouge">String owner</code>: The client that initaited the job request
(e.g. <code class="highlighter-rouge">foouser</code>)</li>
  <li><code class="highlighter-rouge">String name</code>: The name the client given the job</li>
  <li><code class="highlighter-rouge">Map&lt;JobExpectedInputId, JobInput&gt; inputs</code>: The inputs given for the
job.
    <ul>
      <li>Each input is accessible via the dot accessor
(e.g. <code class="highlighter-rouge">request.inputs.firstName</code>).</li>
      <li>The <code class="highlighter-rouge">Map</code> is serializable as JSON (e.g. <code class="highlighter-rouge">toJSON(request.inputs)</code>).</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">JobSpec spec</code>: The job spec the job was submitted against</li>
</ul>

<h3 id="object-inputs"><code class="highlighter-rouge">Object inputs</code></h3>

<p>Shortcut for <code class="highlighter-rouge">request.inputs</code>.</p>

<h3 id="string-outputdir"><code class="highlighter-rouge">String outputDir</code></h3>

<p>The output directory for the job. At time of writing, this is always
the same as the job’s working directory.</p>

	</main>
	
	<nav id="content-nav">
	  <ul>
  <li><a href="index.html">Overview</a></li>
  <li><a href="quickstart.html">Quickstart</a></li>
  <li><a href="https://github.com/adamkewley/jobson">Install</a></li>
  <li><a href="commandline.html">Command-Line Interface</a></li>
  <li><a href="workspaces.html">Workspaces</a></li>
  <li><a href="specs.html">Job Specs</a></li>
  <li><a href="template-expressions.html">Template Expressions</a></li>
  <li><a href="server-configuration.html">Server Configuration</a></li>
</ul>

	</nav>
      </div>
    </section>
  </body>
</html>
